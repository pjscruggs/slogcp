name: Go Lint

on:
  workflow_call:

permissions:
  contents: write

jobs:
  golangci-fix:
    name: 🧐 Go Linting
    runs-on: ubuntu-latest
    steps:
      - name: 🛒 Checkout Code
        uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4
        with:
          ref: ${{ github.event_name == 'pull_request' && github.head_ref || github.ref }}

      - name: 🏗️ Set up Go
        uses: actions/setup-go@0aaccfd150d50ccaeb58ebd88d36e91967a5f35b # v5
        with:
          go-version-file: 'go.mod'
          cache: true

      - name: 🛠️ Install specific golangci-lint version
        uses: golangci/golangci-lint-action@4afd733a84b1f43292c63897423277bb7f4313a9 # v8
        with:
          version: v2.1.5
          install-mode: goinstall

      - name: ✨ Apply Lint Fixes
        run: golangci-lint run --fix ./...
        continue-on-error: true

      - name: 💾 Commit Lint Fixes
        uses: EndBug/add-and-commit@a94899bca583c204427a224a7af87c02f9b325d5 # v9
        with:
          author_name: Go Lint Fix Bot
          author_email: go-lint-fix-bot@users.noreply.github.com
          message: 'chore: apply golangci-lint fixes'
          add: '.'
