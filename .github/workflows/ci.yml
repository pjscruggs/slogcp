name: CI

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]
  merge_group:
    types: [ checks_requested ]
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: read
  security-events: write

jobs:
  format_go:
    name: Format Go
    uses: ./.github/workflows/go-format.yml

  lint_go:
    name: Lint Go Code (Fix)
    needs: [format_go]
    uses: ./.github/workflows/go-lint.yml

  test_and_vuln_check:
    name: Test Go & Vuln Check
    needs: [lint_go]
    uses: ./.github/workflows/go-tests.yml